from typing import Optional
from psycopg2 import connect
from psycopg2._psycopg import connection, cursor
from psycopg2.extensions import ISOLATION_LEVEL_AUTOCOMMIT

dsn = {
    "dbname": "offchaindb",
    "user": "postgres",
    "password": "mysecretpassword",
    "port": "5432",
    "host": "postgresA",
}

conn: Optional[connection] = None
try:
    conn = connect(**dsn)
    conn.set_isolation_level(ISOLATION_LEVEL_AUTOCOMMIT)

    with conn.cursor() as cur:
        cur: cursor

        cur.execute(
            """CREATE TABLE IF NOT EXISTS offchainDB_CFPval(
                    PartsID CHARACTER varying(288),
                    TotalCFP DECIMAL NOT NULL ,
                    CFP DECIMAL NOT NULL ,
                    PRIMARY KEY (PartsID)
            );

            INSERT INTO offchainDB_CFPval VALUES
            ('P00001' ,'0.0', '0.3'),
            ('P00004' ,'0.0', '5.7'),
            ('P00007' ,'0.0', '4.8'),
            ('P00010' ,'0.0', '3.4'),
            ('P00013' ,'0.0', '9.8'),
            ('P00016' ,'0.0', '6.2'),
            ('P00019' ,'0.0', '2.0'),
            ('P00022' ,'0.0', '0.0'),
            ('P00025' ,'0.0', '1.9'),
            ('P00028' ,'0.0', '7.7'),
            ('P00031' ,'0.0', '1.8'),
            ('P00034' ,'0.0', '8.3'),
            ('P00037' ,'0.0', '1.7'),
            ('P00040' ,'0.0', '2.6'),
            ('P00043' ,'0.0', '10.0'),
            ('P00046' ,'0.0', '6.2'),
            ('P00049' ,'0.0', '9.2'),
            ('P00052' ,'0.0', '5.7'),
            ('P00055' ,'0.0', '1.1'),
            ('P00058' ,'0.0', '3.9'),
            ('P00061' ,'0.0', '9.4'),
            ('P00064' ,'0.0', '7.2'),
            ('P00067' ,'0.0', '9.9'),
            ('P00070' ,'0.0', '1.2'),
            ('P00073' ,'0.0', '1.3'),
            ('P00076' ,'0.0', '5.0'),
            ('P00079' ,'0.0', '9.0'),
            ('P00082' ,'0.0', '4.7'),
            ('P00085' ,'0.0', '0.5'),
            ('P00088' ,'0.0', '8.1'),
            ('P00091' ,'0.0', '4.0'),
            ('P00094' ,'0.0', '5.0'),
            ('P00097' ,'0.0', '1.8'),
            ('P00100' ,'0.0', '1.7'),
            ('P00103' ,'0.0', '0.4'),
            ('P00106' ,'0.0', '1.5'),
            ('P00109' ,'0.0', '6.4'),
            ('P00112' ,'0.0', '5.8'),
            ('P00115' ,'0.0', '5.5'),
            ('P00118' ,'0.0', '3.8'),
            ('P00121' ,'0.0', '7.1'),
            ('P00124' ,'0.0', '2.0'),
            ('P00127' ,'0.0', '9.4'),
            ('P00130' ,'0.0', '5.6'),
            ('P00133' ,'0.0', '2.2'),
            ('P00136' ,'0.0', '0.2'),
            ('P00139' ,'0.0', '6.2'),
            ('P00142' ,'0.0', '4.7'),
            ('P00145' ,'0.0', '6.9'),
            ('P00148' ,'0.0', '2.4'),
            ('P00151' ,'0.0', '8.1'),
            ('P00154' ,'0.0', '5.7'),
            ('P00157' ,'0.0', '8.6'),
            ('P00160' ,'0.0', '3.8'),
            ('P00163' ,'0.0', '8.3'),
            ('P00166' ,'0.0', '6.6'),
            ('P00169' ,'0.0', '3.7'),
            ('P00172' ,'0.0', '6.5'),
            ('P00175' ,'0.0', '0.2'),
            ('P00178' ,'0.0', '9.8'),
            ('P00181' ,'0.0', '6.7'),
            ('P00184' ,'0.0', '6.0'),
            ('P00187' ,'0.0', '0.6'),
            ('P00190' ,'0.0', '1.3'),
            ('P00193' ,'0.0', '8.8'),
            ('P00196' ,'0.0', '8.4'),
            ('P00199' ,'0.0', '1.4'),
            ('P00202' ,'0.0', '9.4'),
            ('P00205' ,'0.0', '1.2'),
            ('P00208' ,'0.0', '0.5'),
            ('P00211' ,'0.0', '7.9'),
            ('P00214' ,'0.0', '4.6'),
            ('P00217' ,'0.0', '2.3'),
            ('P00220' ,'0.0', '9.1'),
            ('P00223' ,'0.0', '2.3'),
            ('P00226' ,'0.0', '1.8'),
            ('P00229' ,'0.0', '3.3'),
            ('P00232' ,'0.0', '4.5'),
            ('P00235' ,'0.0', '1.1'),
            ('P00238' ,'0.0', '8.6'),
            ('P00241' ,'0.0', '5.1'),
            ('P00244' ,'0.0', '6.7'),
            ('P00247' ,'0.0', '6.8'),
            ('P00250' ,'0.0', '8.6'),
            ('P00253' ,'0.0', '4.1'),
            ('P00256' ,'0.0', '0.7'),
            ('P00259' ,'0.0', '2.7'),
            ('P00262' ,'0.0', '9.7'),
            ('P00265' ,'0.0', '0.5'),
            ('P00268' ,'0.0', '1.6'),
            ('P00271' ,'0.0', '1.3'),
            ('P00274' ,'0.0', '7.2'),
            ('P00277' ,'0.0', '4.5'),
            ('P00280' ,'0.0', '6.4'),
            ('P00283' ,'0.0', '3.5'),
            ('P00286' ,'0.0', '4.3'),
            ('P00289' ,'0.0', '6.5'),
            ('P00292' ,'0.0', '1.1'),
            ('P00295' ,'0.0', '3.8'),
            ('P00298' ,'0.0', '8.2'),
            ('P00301' ,'0.0', '4.8'),
            ('P00304' ,'0.0', '8.6'),
            ('P00307' ,'0.0', '6.5'),
            ('P00310' ,'0.0', '6.1'),
            ('P00313' ,'0.0', '8.0'),
            ('P00316' ,'0.0', '7.8'),
            ('P00319' ,'0.0', '7.0'),
            ('P00322' ,'0.0', '7.8'),
            ('P00325' ,'0.0', '4.2'),
            ('P00328' ,'0.0', '1.3'),
            ('P00331' ,'0.0', '6.3'),
            ('P00334' ,'0.0', '7.2'),
            ('P00337' ,'0.0', '7.7'),
            ('P00340' ,'0.0', '5.7'),
            ('P00343' ,'0.0', '4.2'),
            ('P00346' ,'0.0', '1.3'),
            ('P00349' ,'0.0', '8.6'),
            ('P00352' ,'0.0', '6.6'),
            ('P00355' ,'0.0', '4.0'),
            ('P00358' ,'0.0', '3.3'),
            ('P00361' ,'0.0', '1.7'),
            ('P00364' ,'0.0', '6.5'),
            ('P00367' ,'0.0', '7.8'),
            ('P00370' ,'0.0', '3.8'),
            ('P00373' ,'0.0', '9.5'),
            ('P00376' ,'0.0', '4.8'),
            ('P00379' ,'0.0', '6.2'),
            ('P00382' ,'0.0', '8.5'),
            ('P00385' ,'0.0', '1.2'),
            ('P00388' ,'0.0', '1.0'),
            ('P00391' ,'0.0', '3.6'),
            ('P00394' ,'0.0', '0.5'),
            ('P00397' ,'0.0', '4.3'),
            ('P00400' ,'0.0', '7.4'),
            ('P00403' ,'0.0', '0.9'),
            ('P00406' ,'0.0', '2.0'),
            ('P00409' ,'0.0', '9.7'),
            ('P00412' ,'0.0', '6.4'),
            ('P00415' ,'0.0', '6.6'),
            ('P00418' ,'0.0', '4.8'),
            ('P00421' ,'0.0', '4.4'),
            ('P00424' ,'0.0', '0.9'),
            ('P00427' ,'0.0', '4.9'),
            ('P00430' ,'0.0', '5.4'),
            ('P00433' ,'0.0', '1.4'),
            ('P00436' ,'0.0', '1.7'),
            ('P00439' ,'0.0', '6.2'),
            ('P00442' ,'0.0', '0.3'),
            ('P00445' ,'0.0', '8.3'),
            ('P00448' ,'0.0', '3.0'),
            ('P00451' ,'0.0', '4.5'),
            ('P00454' ,'0.0', '0.1'),
            ('P00457' ,'0.0', '5.0'),
            ('P00460' ,'0.0', '0.5'),
            ('P00463' ,'0.0', '3.4'),
            ('P00466' ,'0.0', '1.2'),
            ('P00469' ,'0.0', '5.0'),
            ('P00472' ,'0.0', '1.6'),
            ('P00475' ,'0.0', '2.2'),
            ('P00478' ,'0.0', '9.1'),
            ('P00481' ,'0.0', '1.3'),
            ('P00484' ,'0.0', '1.9'),
            ('P00487' ,'0.0', '6.1'),
            ('P00490' ,'0.0', '5.1'),
            ('P00493' ,'0.0', '5.8'),
            ('P00496' ,'0.0', '7.4'),
            ('P00499' ,'0.0', '3.6'),

            ('P00502' ,'0.0', '4.8'),
            ('P00505' ,'0.0', '0.5'),
            ('P00508' ,'0.0', '9.8'),
            ('P00511' ,'0.0', '6.6'),
            ('P00514' ,'0.0', '3.2'),
            ('P00517' ,'0.0', '6.8'),
            ('P00520' ,'0.0', '9.8'),
            ('P00523' ,'0.0', '4.4'),
            ('P00526' ,'0.0', '4.5'),
            ('P00529' ,'0.0', '7.7'),
            ('P00532' ,'0.0', '3.3'),
            ('P00535' ,'0.0', '2.6'),
            ('P00538' ,'0.0', '5.8'),
            ('P00541' ,'0.0', '0.1'),
            ('P00544' ,'0.0', '0.2'),
            ('P00547' ,'0.0', '3.0'),
            ('P00550' ,'0.0', '3.8'),
            ('P00553' ,'0.0', '8.1'),
            ('P00556' ,'0.0', '5.3'),
            ('P00559' ,'0.0', '9.7'),
            ('P00562' ,'0.0', '7.8'),
            ('P00565' ,'0.0', '0.2'),
            ('P00568' ,'0.0', '1.9'),
            ('P00571' ,'0.0', '1.0'),
            ('P00574' ,'0.0', '2.8'),
            ('P00577' ,'0.0', '3.2'),
            ('P00580' ,'0.0', '5.9'),
            ('P00583' ,'0.0', '6.8'),
            ('P00586' ,'0.0', '6.8'),
            ('P00589' ,'0.0', '2.9'),
            ('P00592' ,'0.0', '3.0'),
            ('P00595' ,'0.0', '7.8'),
            ('P00598' ,'0.0', '7.1'),
            ('P00601' ,'0.0', '1.1'),
            ('P00604' ,'0.0', '2.6'),
            ('P00607' ,'0.0', '2.8'),
            ('P00610' ,'0.0', '3.0'),
            ('P00613' ,'0.0', '4.3'),
            ('P00616' ,'0.0', '1.3'),
            ('P00619' ,'0.0', '0.2'),
            ('P00622' ,'0.0', '9.6'),
            ('P00625' ,'0.0', '3.7'),
            ('P00628' ,'0.0', '4.5'),
            ('P00631' ,'0.0', '8.1'),
            ('P00634' ,'0.0', '6.7'),
            ('P00637' ,'0.0', '2.6'),
            ('P00640' ,'0.0', '9.6'),
            ('P00643' ,'0.0', '5.6'),
            ('P00646' ,'0.0', '6.3'),
            ('P00649' ,'0.0', '2.9'),
            ('P00652' ,'0.0', '0.4'),
            ('P00655' ,'0.0', '4.7'),
            ('P00658' ,'0.0', '0.7'),
            ('P00661' ,'0.0', '5.9'),
            ('P00664' ,'0.0', '1.9'),
            ('P00667' ,'0.0', '9.5'),
            ('P00670' ,'0.0', '2.8'),
            ('P00673' ,'0.0', '9.5'),
            ('P00676' ,'0.0', '8.0'),
            ('P00679' ,'0.0', '3.3'),
            ('P00682' ,'0.0', '1.3'),
            ('P00685' ,'0.0', '9.7'),
            ('P00688' ,'0.0', '9.5'),
            ('P00691' ,'0.0', '9.1'),
            ('P00694' ,'0.0', '8.3'),
            ('P00697' ,'0.0', '7.2'),
            ('P00700' ,'0.0', '1.2'),
            ('P00703' ,'0.0', '6.1'),
            ('P00706' ,'0.0', '2.0'),
            ('P00709' ,'0.0', '6.7'),
            ('P00712' ,'0.0', '8.2'),
            ('P00715' ,'0.0', '8.4'),
            ('P00718' ,'0.0', '7.9'),
            ('P00721' ,'0.0', '8.1'),
            ('P00724' ,'0.0', '0.7'),
            ('P00727' ,'0.0', '1.6'),
            ('P00730' ,'0.0', '5.7'),
            ('P00733' ,'0.0', '1.8'),
            ('P00736' ,'0.0', '4.7'),
            ('P00739' ,'0.0', '2.9'),
            ('P00742' ,'0.0', '0.6'),
            ('P00745' ,'0.0', '4.6'),
            ('P00748' ,'0.0', '1.0'),
            ('P00751' ,'0.0', '6.5'),
            ('P00754' ,'0.0', '1.6'),
            ('P00757' ,'0.0', '5.8'),
            ('P00760' ,'0.0', '5.9'),
            ('P00763' ,'0.0', '8.3'),
            ('P00766' ,'0.0', '0.2'),
            ('P00769' ,'0.0', '9.9'),
            ('P00772' ,'0.0', '4.3'),
            ('P00775' ,'0.0', '3.1'),
            ('P00778' ,'0.0', '4.2'),
            ('P00781' ,'0.0', '2.0'),
            ('P00784' ,'0.0', '8.9'),
            ('P00787' ,'0.0', '8.4'),
            ('P00790' ,'0.0', '1.9'),
            ('P00793' ,'0.0', '2.0'),
            ('P00796' ,'0.0', '8.8'),
            ('P00799' ,'0.0', '8.9'),
            ('P00802' ,'0.0', '2.5'),
            ('P00805' ,'0.0', '5.0'),
            ('P00808' ,'0.0', '3.2'),
            ('P00811' ,'0.0', '7.6'),
            ('P00814' ,'0.0', '4.1'),
            ('P00817' ,'0.0', '7.0'),
            ('P00820' ,'0.0', '0.9'),
            ('P00823' ,'0.0', '5.5'),
            ('P00826' ,'0.0', '8.2'),
            ('P00829' ,'0.0', '8.1'),
            ('P00832' ,'0.0', '1.3'),
            ('P00835' ,'0.0', '7.5'),
            ('P00838' ,'0.0', '1.9'),
            ('P00841' ,'0.0', '0.8'),
            ('P00844' ,'0.0', '9.4'),
            ('P00847' ,'0.0', '6.0'),
            ('P00850' ,'0.0', '8.6'),
            ('P00853' ,'0.0', '6.3'),
            ('P00856' ,'0.0', '7.6'),
            ('P00859' ,'0.0', '0.1'),
            ('P00862' ,'0.0', '7.0'),
            ('P00865' ,'0.0', '9.1'),
            ('P00868' ,'0.0', '2.4'),
            ('P00871' ,'0.0', '7.1'),
            ('P00874' ,'0.0', '5.0'),
            ('P00877' ,'0.0', '3.4'),
            ('P00880' ,'0.0', '4.4'),
            ('P00883' ,'0.0', '6.6'),
            ('P00886' ,'0.0', '1.0'),
            ('P00889' ,'0.0', '1.1'),
            ('P00892' ,'0.0', '3.0'),
            ('P00895' ,'0.0', '6.2'),
            ('P00898' ,'0.0', '8.0'),
            ('P00901' ,'0.0', '1.6'),
            ('P00904' ,'0.0', '0.3'),
            ('P00907' ,'0.0', '0.2'),
            ('P00910' ,'0.0', '5.8'),
            ('P00913' ,'0.0', '4.3'),
            ('P00916' ,'0.0', '6.0'),
            ('P00919' ,'0.0', '0.5'),
            ('P00922' ,'0.0', '8.5'),
            ('P00925' ,'0.0', '10.0'),
            ('P00928' ,'0.0', '3.0'),
            ('P00931' ,'0.0', '2.8'),
            ('P00934' ,'0.0', '2.9'),
            ('P00937' ,'0.0', '8.1'),
            ('P00940' ,'0.0', '1.6'),
            ('P00943' ,'0.0', '2.4'),
            ('P00946' ,'0.0', '9.6'),
            ('P00949' ,'0.0', '5.6'),
            ('P00952' ,'0.0', '9.2'),
            ('P00955' ,'0.0', '8.6'),
            ('P00958' ,'0.0', '0.9'),
            ('P00961' ,'0.0', '8.8'),
            ('P00964' ,'0.0', '6.5'),
            ('P00967' ,'0.0', '2.2'),
            ('P00970' ,'0.0', '4.2'),
            ('P00973' ,'0.0', '6.7'),
            ('P00976' ,'0.0', '8.3'),
            ('P00979' ,'0.0', '6.9'),
            ('P00982' ,'0.0', '1.8'),
            ('P00985' ,'0.0', '7.7'),
            ('P00988' ,'0.0', '7.0'),
            ('P00991' ,'0.0', '6.6'),
            ('P00994' ,'0.0', '1.7'),
            ('P00997' ,'0.0', '6.2'),
            ('P01000' ,'0.0', '0.6');"""
        )
finally:
    if conn:
        conn.close()
