from typing import Optional
from psycopg2 import connect
from psycopg2._psycopg import connection, cursor
from psycopg2.extensions import ISOLATION_LEVEL_AUTOCOMMIT

dsn = {
    "dbname": "offchaindb",
    "user": "postgres",
    "password": "mysecretpassword",
    "port": "5432",
    "host": "postgresB",
}

conn: Optional[connection] = None
try:
    conn = connect(**dsn)
    conn.set_isolation_level(ISOLATION_LEVEL_AUTOCOMMIT)

    with conn.cursor() as cur:
        cur: cursor

        cur.execute(
            """CREATE TABLE IF NOT EXISTS offchainDB_CFPval(
                    PartsID CHARACTER varying(288),
                    TotalCFP DECIMAL NOT NULL ,
                    CFP DECIMAL NOT NULL ,
                    PRIMARY KEY (PartsID)
            );

            INSERT INTO offchainDB_CFPval VALUES
            ('P00002', '0.0', '5.8'),
            ('P00005', '0.0', '6.7'),
            ('P00008', '0.0', '7.4'),
            ('P00011', '0.0', '5.9'),
            ('P00014', '0.0', '1.5'),
            ('P00017', '0.0', '1.7'),
            ('P00020', '0.0', '7.4'),
            ('P00023', '0.0', '10.0'),
            ('P00026', '0.0', '4.3'),
            ('P00029', '0.0', '7.8'),
            ('P00032', '0.0', '4.7'),
            ('P00035', '0.0', '4.7'),
            ('P00038', '0.0', '7.5'),
            ('P00041', '0.0', '8.7'),
            ('P00044', '0.0', '4.0'),
            ('P00047', '0.0', '1.1'),
            ('P00050', '0.0', '8.6'),
            ('P00053', '0.0', '2.5'),
            ('P00056', '0.0', '6.0'),
            ('P00059', '0.0', '4.3'),
            ('P00062', '0.0', '6.4'),
            ('P00065', '0.0', '8.3'),
            ('P00068', '0.0', '1.5'),
            ('P00071', '0.0', '6.8'),
            ('P00074', '0.0', '8.1'),
            ('P00077', '0.0', '9.1'),
            ('P00080', '0.0', '4.2'),
            ('P00083', '0.0', '7.4'),
            ('P00086', '0.0', '6.6'),
            ('P00089', '0.0', '3.1'),
            ('P00092', '0.0', '7.0'),
            ('P00095', '0.0', '4.5'),
            ('P00098', '0.0', '8.6'),
            ('P00101', '0.0', '8.5'),
            ('P00104', '0.0', '3.5'),
            ('P00107', '0.0', '3.8'),
            ('P00110', '0.0', '1.1'),
            ('P00113', '0.0', '0.8'),
            ('P00116', '0.0', '9.1'),
            ('P00119', '0.0', '6.2'),
            ('P00122', '0.0', '5.0'),
            ('P00125', '0.0', '1.6'),
            ('P00128', '0.0', '7.6'),
            ('P00131', '0.0', '8.9'),
            ('P00134', '0.0', '8.9'),
            ('P00137', '0.0', '0.9'),
            ('P00140', '0.0', '5.9'),
            ('P00143', '0.0', '10.0'),
            ('P00146', '0.0', '3.6'),
            ('P00149', '0.0', '0.8'),
            ('P00152', '0.0', '9.9'),
            ('P00155', '0.0', '9.7'),
            ('P00158', '0.0', '2.7'),
            ('P00161', '0.0', '5.6'),
            ('P00164', '0.0', '2.0'),
            ('P00167', '0.0', '4.8'),
            ('P00170', '0.0', '0.6'),
            ('P00173', '0.0', '2.0'),
            ('P00176', '0.0', '7.9'),
            ('P00179', '0.0', '0.5'),
            ('P00182', '0.0', '4.9'),
            ('P00185', '0.0', '5.1'),
            ('P00188', '0.0', '7.5'),
            ('P00191', '0.0', '3.8'),
            ('P00194', '0.0', '5.2'),
            ('P00197', '0.0', '1.1'),
            ('P00200', '0.0', '6.7'),
            ('P00203', '0.0', '8.6'),
            ('P00206', '0.0', '7.0'),
            ('P00209', '0.0', '4.7'),
            ('P00212', '0.0', '9.3'),
            ('P00215', '0.0', '5.7'),
            ('P00218', '0.0', '3.0'),
            ('P00221', '0.0', '0.8'),
            ('P00224', '0.0', '5.1'),
            ('P00227', '0.0', '3.2'),
            ('P00230', '0.0', '3.9'),
            ('P00233', '0.0', '9.8'),
            ('P00236', '0.0', '7.7'),
            ('P00239', '0.0', '7.9'),
            ('P00242', '0.0', '3.8'),
            ('P00245', '0.0', '7.2'),
            ('P00248', '0.0', '6.8'),
            ('P00251', '0.0', '1.5'),
            ('P00254', '0.0', '8.6'),
            ('P00257', '0.0', '1.1'),
            ('P00260', '0.0', '6.5'),
            ('P00263', '0.0', '9.1'),
            ('P00266', '0.0', '3.5'),
            ('P00269', '0.0', '0.9'),
            ('P00272', '0.0', '5.0'),
            ('P00275', '0.0', '6.1'),
            ('P00278', '0.0', '9.8'),
            ('P00281', '0.0', '2.8'),
            ('P00284', '0.0', '8.5'),
            ('P00287', '0.0', '4.4'),
            ('P00290', '0.0', '4.8'),
            ('P00293', '0.0', '0.1'),
            ('P00296', '0.0', '9.5'),
            ('P00299', '0.0', '0.9'),
            ('P00302', '0.0', '8.3'),
            ('P00305', '0.0', '3.5'),
            ('P00308', '0.0', '8.5'),
            ('P00311', '0.0', '7.4'),
            ('P00314', '0.0', '6.2'),
            ('P00317', '0.0', '8.6'),
            ('P00320', '0.0', '4.2'),
            ('P00323', '0.0', '4.1'),
            ('P00326', '0.0', '7.2'),
            ('P00329', '0.0', '4.9'),
            ('P00332', '0.0', '4.0'),
            ('P00335', '0.0', '0.8'),
            ('P00338', '0.0', '3.3'),
            ('P00341', '0.0', '2.4'),
            ('P00344', '0.0', '7.6'),
            ('P00347', '0.0', '6.8'),
            ('P00350', '0.0', '0.3'),
            ('P00353', '0.0', '2.9'),
            ('P00356', '0.0', '0.2'),
            ('P00359', '0.0', '1.9'),
            ('P00362', '0.0', '2.0'),
            ('P00365', '0.0', '9.1'),
            ('P00368', '0.0', '8.0'),
            ('P00371', '0.0', '9.1'),
            ('P00374', '0.0', '7.3'),
            ('P00377', '0.0', '5.0'),
            ('P00380', '0.0', '9.6'),
            ('P00383', '0.0', '3.9'),
            ('P00386', '0.0', '0.4'),
            ('P00389', '0.0', '1.0'),
            ('P00392', '0.0', '4.2'),
            ('P00395', '0.0', '2.6'),
            ('P00398', '0.0', '7.8'),
            ('P00401', '0.0', '2.1'),
            ('P00404', '0.0', '7.8'),
            ('P00407', '0.0', '2.9'),
            ('P00410', '0.0', '0.6'),
            ('P00413', '0.0', '3.2'),
            ('P00416', '0.0', '1.6'),
            ('P00419', '0.0', '6.6'),
            ('P00422', '0.0', '0.3'),
            ('P00425', '0.0', '0.9'),
            ('P00428', '0.0', '0.2'),
            ('P00431', '0.0', '9.5'),
            ('P00434', '0.0', '3.4'),
            ('P00437', '0.0', '7.5'),
            ('P00440', '0.0', '1.7'),
            ('P00443', '0.0', '2.5'),
            ('P00446', '0.0', '0.5'),
            ('P00449', '0.0', '7.9'),
            ('P00452', '0.0', '5.2'),
            ('P00455', '0.0', '3.0'),
            ('P00458', '0.0', '0.8'),
            ('P00461', '0.0', '2.5'),
            ('P00464', '0.0', '2.2'),
            ('P00467', '0.0', '1.4'),
            ('P00470', '0.0', '9.9'),
            ('P00473', '0.0', '4.8'),
            ('P00476', '0.0', '4.7'),
            ('P00479', '0.0', '1.5'),
            ('P00482', '0.0', '6.7'),
            ('P00485', '0.0', '8.5'),
            ('P00488', '0.0', '8.5'),
            ('P00491', '0.0', '3.1'),
            ('P00494', '0.0', '8.1'),
            ('P00497', '0.0', '2.2'),
            ('P00500', '0.0', '8.3'),
            ('P00503', '0.0', '6.3'),
            ('P00506', '0.0', '0.5'),
            ('P00509', '0.0', '4.8'),
            ('P00512', '0.0', '7.9'),
            ('P00515', '0.0', '4.2'),
            ('P00518', '0.0', '2.7'),
            ('P00521', '0.0', '6.1'),
            ('P00524', '0.0', '4.8'),
            ('P00527', '0.0', '7.8'),
            ('P00530', '0.0', '7.8'),
            ('P00533', '0.0', '1.7'),
            ('P00536', '0.0', '4.7'),
            ('P00539', '0.0', '3.2'),
            ('P00542', '0.0', '1.4'),
            ('P00545', '0.0', '4.9'),
            ('P00548', '0.0', '5.5'),
            ('P00551', '0.0', '7.6'),
            ('P00554', '0.0', '7.5'),
            ('P00557', '0.0', '6.8'),
            ('P00560', '0.0', '2.6'),
            ('P00563', '0.0', '4.8'),
            ('P00566', '0.0', '6.5'),
            ('P00569', '0.0', '1.3'),
            ('P00572', '0.0', '5.0'),
            ('P00575', '0.0', '4.5'),
            ('P00578', '0.0', '6.6'),
            ('P00581', '0.0', '5.0'),
            ('P00584', '0.0', '6.1'),
            ('P00587', '0.0', '1.1'),
            ('P00590', '0.0', '2.3'),
            ('P00593', '0.0', '1.3'),
            ('P00596', '0.0', '6.8'),
            ('P00599', '0.0', '0.7'),
            ('P00602', '0.0', '3.4'),
            ('P00605', '0.0', '4.1'),
            ('P00608', '0.0', '7.1'),
            ('P00611', '0.0', '1.8'),
            ('P00614', '0.0', '0.7'),
            ('P00617', '0.0', '8.4'),
            ('P00620', '0.0', '0.9'),
            ('P00623', '0.0', '4.6'),
            ('P00626', '0.0', '9.7'),
            ('P00629', '0.0', '3.0'),
            ('P00632', '0.0', '6.1'),
            ('P00635', '0.0', '2.8'),
            ('P00638', '0.0', '5.9'),
            ('P00641', '0.0', '8.6'),
            ('P00644', '0.0', '3.6'),
            ('P00647', '0.0', '4.5'),
            ('P00650', '0.0', '3.8'),
            ('P00653', '0.0', '5.4'),
            ('P00656', '0.0', '5.4'),
            ('P00659', '0.0', '0.4'),
            ('P00662', '0.0', '5.7'),
            ('P00665', '0.0', '10.0'),
            ('P00668', '0.0', '8.6'),
            ('P00671', '0.0', '1.1'),
            ('P00674', '0.0', '5.0'),
            ('P00677', '0.0', '2.7'),
            ('P00680', '0.0', '4.6'),
            ('P00683', '0.0', '2.2'),
            ('P00686', '0.0', '9.2'),
            ('P00689', '0.0', '1.7'),
            ('P00692', '0.0', '2.0'),
            ('P00695', '0.0', '1.4'),
            ('P00698', '0.0', '5.6'),
            ('P00701', '0.0', '2.4'),
            ('P00704', '0.0', '3.4'),
            ('P00707', '0.0', '2.8'),
            ('P00710', '0.0', '0.4'),
            ('P00713', '0.0', '6.2'),
            ('P00716', '0.0', '6.5'),
            ('P00719', '0.0', '5.0'),
            ('P00722', '0.0', '1.6'),
            ('P00725', '0.0', '2.1'),
            ('P00728', '0.0', '9.2'),
            ('P00731', '0.0', '1.8'),
            ('P00734', '0.0', '6.5'),
            ('P00737', '0.0', '1.3'),
            ('P00740', '0.0', '2.8'),
            ('P00743', '0.0', '2.8'),
            ('P00746', '0.0', '3.7'),
            ('P00749', '0.0', '2.2'),
            ('P00752', '0.0', '1.5'),
            ('P00755', '0.0', '6.0'),
            ('P00758', '0.0', '9.1'),
            ('P00761', '0.0', '8.0'),
            ('P00764', '0.0', '7.1'),
            ('P00767', '0.0', '9.5'),
            ('P00770', '0.0', '7.7'),
            ('P00773', '0.0', '5.9'),
            ('P00776', '0.0', '5.0'),
            ('P00779', '0.0', '0.6'),
            ('P00782', '0.0', '9.1'),
            ('P00785', '0.0', '5.5'),
            ('P00788', '0.0', '6.8'),
            ('P00791', '0.0', '7.0'),
            ('P00794', '0.0', '2.1'),
            ('P00797', '0.0', '7.0'),
            ('P00800', '0.0', '4.2'),
            ('P00803', '0.0', '9.7'),
            ('P00806', '0.0', '3.9'),
            ('P00809', '0.0', '5.1'),
            ('P00812', '0.0', '2.2'),
            ('P00815', '0.0', '2.8'),
            ('P00818', '0.0', '2.5'),
            ('P00821', '0.0', '9.1'),
            ('P00824', '0.0', '2.7'),
            ('P00827', '0.0', '9.4'),
            ('P00830', '0.0', '6.2'),
            ('P00833', '0.0', '8.5'),
            ('P00836', '0.0', '2.9'),
            ('P00839', '0.0', '5.5'),
            ('P00842', '0.0', '6.8'),
            ('P00845', '0.0', '2.8'),
            ('P00848', '0.0', '5.3'),
            ('P00851', '0.0', '6.2'),
            ('P00854', '0.0', '9.8'),
            ('P00857', '0.0', '8.9'),
            ('P00860', '0.0', '6.1'),
            ('P00863', '0.0', '6.0'),
            ('P00866', '0.0', '5.1'),
            ('P00869', '0.0', '6.3'),
            ('P00872', '0.0', '2.6'),
            ('P00875', '0.0', '0.8'),
            ('P00878', '0.0', '1.8'),
            ('P00881', '0.0', '2.4'),
            ('P00884', '0.0', '7.8'),
            ('P00887', '0.0', '9.5'),
            ('P00890', '0.0', '6.9'),
            ('P00893', '0.0', '4.1'),
            ('P00896', '0.0', '10.1'),
            ('P00899', '0.0', '4.8'),
            ('P00902', '0.0', '1.4'),
            ('P00905', '0.0', '8.0'),
            ('P00908', '0.0', '7.9'),
            ('P00911', '0.0', '2.8'),
            ('P00914', '0.0', '6.6'),
            ('P00917', '0.0', '1.3'),
            ('P00920', '0.0', '1.0'),
            ('P00923', '0.0', '9.5'),
            ('P00926', '0.0', '2.3'),
            ('P00929', '0.0', '2.0'),
            ('P00932', '0.0', '8.5'),
            ('P00935', '0.0', '4.9'),
            ('P00938', '0.0', '2.7'),
            ('P00941', '0.0', '5.0'),
            ('P00944', '0.0', '4.7'),
            ('P00947', '0.0', '5.5'),
            ('P00950', '0.0', '9.4'),
            ('P00953', '0.0', '2.1'),
            ('P00956', '0.0', '10.0'),
            ('P00959', '0.0', '4.7'),
            ('P00962', '0.0', '1.9'),
            ('P00965', '0.0', '9.5'),
            ('P00968', '0.0', '7.8'),
            ('P00971', '0.0', '6.0'),
            ('P00974', '0.0', '5.9'),
            ('P00977', '0.0', '3.1'),
            ('P00980', '0.0', '5.2'),
            ('P00983', '0.0', '6.3'),
            ('P00986', '0.0', '0.8'),
            ('P00989', '0.0', '4.8'),
            ('P00992', '0.0', '6.6'),
            ('P00995', '0.0', '7.9'),
            ('P00998', '0.0', '4.8');"""
        )
finally:
    if conn:
        conn.close()
