from typing import Optional
from psycopg2 import connect
from psycopg2._psycopg import connection, cursor
from psycopg2.extensions import ISOLATION_LEVEL_AUTOCOMMIT

dsn = {
    "dbname": "offchaindb",
    "user": "postgres",
    "password": "mysecretpassword",
    "port": "5432",
    "host": "postgresC",
}

conn: Optional[connection] = None
try:
    conn = connect(**dsn)
    conn.set_isolation_level(ISOLATION_LEVEL_AUTOCOMMIT)

    with conn.cursor() as cur:
        cur: cursor

        cur.execute(
            """CREATE TABLE IF NOT EXISTS offchainDB_CFPval(
                    PartsID CHARACTER varying(288),
                    TotalCFP DECIMAL NOT NULL ,
                    CFP DECIMAL NOT NULL ,
                    PRIMARY KEY (PartsID)
            );

            INSERT INTO offchainDB_CFPval VALUES
            ('P00003', '0.0', '8.1'),
            ('P00006', '0.0', '0.3'),
            ('P00009', '0.0', '7.8'),
            ('P00012', '0.0', '7.9'),
            ('P00015', '0.0', '5.6'),
            ('P00018', '0.0', '4.1'),
            ('P00021', '0.0', '9.3'),
            ('P00024', '0.0', '7.5'),
            ('P00027', '0.0', '8.0'),
            ('P00030', '0.0', '8.2'),
            ('P00033', '0.0', '8.6'),
            ('P00036', '0.0', '3.8'),
            ('P00039', '0.0', '9.1'),
            ('P00042', '0.0', '2.4'),
            ('P00045', '0.0', '7.9'),
            ('P00048', '0.0', '0.9'),
            ('P00051', '0.0', '9.3'),
            ('P00054', '0.0', '7.0'),
            ('P00057', '0.0', '7.3'),
            ('P00060', '0.0', '0.7'),
            ('P00063', '0.0', '2.5'),
            ('P00066', '0.0', '9.2'),
            ('P00069', '0.0', '4.4'),
            ('P00072', '0.0', '7.6'),
            ('P00075', '0.0', '9.7'),
            ('P00078', '0.0', '0.3'),
            ('P00081', '0.0', '4.9'),
            ('P00084', '0.0', '6.9'),
            ('P00087', '0.0', '10.0'),
            ('P00090', '0.0', '7.0'),
            ('P00093', '0.0', '7.8'),
            ('P00096', '0.0', '5.9'),
            ('P00099', '0.0', '6.0'),
            ('P00102', '0.0', '7.2'),
            ('P00105', '0.0', '4.4'),
            ('P00108', '0.0', '3.4'),
            ('P00111', '0.0', '3.7'),
            ('P00114', '0.0', '5.5'),
            ('P00117', '0.0', '6.8'),
            ('P00120', '0.0', '9.2'),
            ('P00123', '0.0', '6.0'),
            ('P00126', '0.0', '6.0'),
            ('P00129', '0.0', '5.4'),
            ('P00132', '0.0', '2.0'),
            ('P00135', '0.0', '5.9'),
            ('P00138', '0.0', '7.6'),
            ('P00141', '0.0', '2.6'),
            ('P00144', '0.0', '4.0'),
            ('P00147', '0.0', '2.3'),
            ('P00150', '0.0', '1.2'),
            ('P00153', '0.0', '0.7'),
            ('P00156', '0.0', '8.0'),
            ('P00159', '0.0', '7.4'),
            ('P00162', '0.0', '2.4'),
            ('P00165', '0.0', '2.8'),
            ('P00168', '0.0', '4.3'),
            ('P00171', '0.0', '7.8'),
            ('P00174', '0.0', '3.6'),
            ('P00177', '0.0', '3.3'),
            ('P00180', '0.0', '8.7'),
            ('P00183', '0.0', '7.0'),
            ('P00186', '0.0', '1.5'),
            ('P00189', '0.0', '6.4'),
            ('P00192', '0.0', '0.8'),
            ('P00195', '0.0', '9.2'),
            ('P00198', '0.0', '8.7'),
            ('P00201', '0.0', '5.5'),
            ('P00204', '0.0', '7.1'),
            ('P00207', '0.0', '3.4'),
            ('P00210', '0.0', '5.8'),
            ('P00213', '0.0', '5.2'),
            ('P00216', '0.0', '8.9'),
            ('P00219', '0.0', '8.8'),
            ('P00222', '0.0', '5.3'),
            ('P00225', '0.0', '7.2'),
            ('P00228', '0.0', '0.3'),
            ('P00231', '0.0', '7.1'),
            ('P00234', '0.0', '2.9'),
            ('P00237', '0.0', '6.9'),
            ('P00240', '0.0', '2.4'),
            ('P00243', '0.0', '2.2'),
            ('P00246', '0.0', '9.2'),
            ('P00249', '0.0', '0.2'),
            ('P00252', '0.0', '7.0'),
            ('P00255', '0.0', '2.1'),
            ('P00258', '0.0', '2.7'),
            ('P00261', '0.0', '9.1'),
            ('P00264', '0.0', '0.2'),
            ('P00267', '0.0', '8.6'),
            ('P00270', '0.0', '6.0'),
            ('P00273', '0.0', '0.4'),
            ('P00276', '0.0', '8.7'),
            ('P00279', '0.0', '6.7'),
            ('P00282', '0.0', '7.5'),
            ('P00285', '0.0', '0.7'),
            ('P00288', '0.0', '2.7'),
            ('P00291', '0.0', '0.2'),
            ('P00294', '0.0', '7.4'),
            ('P00297', '0.0', '0.5'),
            ('P00300', '0.0', '7.1'),
            ('P00303', '0.0', '6.1'),
            ('P00306', '0.0', '8.1'),
            ('P00309', '0.0', '1.6'),
            ('P00312', '0.0', '0.8'),
            ('P00315', '0.0', '4.7'),
            ('P00318', '0.0', '8.0'),
            ('P00321', '0.0', '1.5'),
            ('P00324', '0.0', '7.8'),
            ('P00327', '0.0', '7.6'),
            ('P00330', '0.0', '2.6'),
            ('P00333', '0.0', '8.6'),
            ('P00336', '0.0', '5.4'),
            ('P00339', '0.0', '6.1'),
            ('P00342', '0.0', '1.8'),
            ('P00345', '0.0', '2.9'),
            ('P00348', '0.0', '7.5'),
            ('P00351', '0.0', '9.2'),
            ('P00354', '0.0', '0.3'),
            ('P00357', '0.0', '7.9'),
            ('P00360', '0.0', '4.7'),
            ('P00363', '0.0', '4.4'),
            ('P00366', '0.0', '2.6'),
            ('P00369', '0.0', '1.1'),
            ('P00372', '0.0', '3.7'),
            ('P00375', '0.0', '7.5'),
            ('P00378', '0.0', '1.7'),
            ('P00381', '0.0', '1.5'),
            ('P00384', '0.0', '3.9'),
            ('P00387', '0.0', '9.7'),
            ('P00390', '0.0', '5.8'),
            ('P00393', '0.0', '3.4'),
            ('P00396', '0.0', '9.2'),
            ('P00399', '0.0', '3.7'),
            ('P00402', '0.0', '4.1'),
            ('P00405', '0.0', '3.1'),
            ('P00408', '0.0', '6.1'),
            ('P00411', '0.0', '4.7'),
            ('P00414', '0.0', '5.3'),
            ('P00417', '0.0', '6.6'),
            ('P00420', '0.0', '7.9'),
            ('P00423', '0.0', '8.2'),
            ('P00426', '0.0', '4.5'),
            ('P00429', '0.0', '7.3'),
            ('P00432', '0.0', '7.3'),
            ('P00435', '0.0', '1.5'),
            ('P00438', '0.0', '5.7'),
            ('P00441', '0.0', '8.7'),
            ('P00444', '0.0', '0.2'),
            ('P00447', '0.0', '4.8'),
            ('P00450', '0.0', '9.8'),
            ('P00453', '0.0', '7.9'),
            ('P00456', '0.0', '3.6'),
            ('P00459', '0.0', '8.8'),
            ('P00462', '0.0', '5.2'),
            ('P00465', '0.0', '7.3'),
            ('P00468', '0.0', '5.7'),
            ('P00471', '0.0', '7.1'),
            ('P00474', '0.0', '3.5'),
            ('P00477', '0.0', '1.0'),
            ('P00480', '0.0', '4.5'),
            ('P00483', '0.0', '6.6'),
            ('P00486', '0.0', '2.9'),
            ('P00489', '0.0', '6.7'),
            ('P00492', '0.0', '5.0'),
            ('P00495', '0.0', '7.5'),
            ('P00498', '0.0', '6.3'),
            ('P00501', '0.0', '3.5'),
            ('P00504', '0.0', '6.2'),
            ('P00507', '0.0', '0.0'),
            ('P00510', '0.0', '7.0'),
            ('P00513', '0.0', '6.0'),
            ('P00516', '0.0', '6.8'),
            ('P00519', '0.0', '4.6'),
            ('P00522', '0.0', '2.3'),
            ('P00525', '0.0', '10.0'),
            ('P00528', '0.0', '3.7'),
            ('P00531', '0.0', '1.2'),
            ('P00534', '0.0', '6.4'),
            ('P00537', '0.0', '8.8'),
            ('P00540', '0.0', '6.7'),
            ('P00543', '0.0', '1.5'),
            ('P00546', '0.0', '5.4'),
            ('P00549', '0.0', '2.4'),
            ('P00552', '0.0', '2.7'),
            ('P00555', '0.0', '8.4'),
            ('P00558', '0.0', '0.3'),
            ('P00561', '0.0', '5.6'),
            ('P00564', '0.0', '6.0'),
            ('P00567', '0.0', '5.7'),
            ('P00570', '0.0', '2.7'),
            ('P00573', '0.0', '6.5'),
            ('P00576', '0.0', '1.2'),
            ('P00579', '0.0', '6.4'),
            ('P00582', '0.0', '1.9'),
            ('P00585', '0.0', '4.4'),
            ('P00588', '0.0', '3.3'),
            ('P00591', '0.0', '2.5'),
            ('P00594', '0.0', '9.9'),
            ('P00597', '0.0', '5.6'),
            ('P00600', '0.0', '8.5'),
            ('P00603', '0.0', '6.3'),
            ('P00606', '0.0', '4.7'),
            ('P00609', '0.0', '4.0'),
            ('P00612', '0.0', '0.8'),
            ('P00615', '0.0', '8.9'),
            ('P00618', '0.0', '7.1'),
            ('P00621', '0.0', '8.8'),
            ('P00624', '0.0', '0.3'),
            ('P00627', '0.0', '0.9'),
            ('P00630', '0.0', '5.1'),
            ('P00633', '0.0', '1.0'),
            ('P00636', '0.0', '9.4'),
            ('P00639', '0.0', '9.8'),
            ('P00642', '0.0', '8.6'),
            ('P00645', '0.0', '0.8'),
            ('P00648', '0.0', '2.6'),
            ('P00651', '0.0', '9.0'),
            ('P00654', '0.0', '4.5'),
            ('P00657', '0.0', '4.0'),
            ('P00660', '0.0', '5.3'),
            ('P00663', '0.0', '1.7'),
            ('P00666', '0.0', '9.5'),
            ('P00669', '0.0', '2.3'),
            ('P00672', '0.0', '8.1'),
            ('P00675', '0.0', '4.6'),
            ('P00678', '0.0', '3.3'),
            ('P00681', '0.0', '3.1'),
            ('P00684', '0.0', '6.3'),
            ('P00687', '0.0', '2.0'),
            ('P00690', '0.0', '1.3'),
            ('P00693', '0.0', '6.7'),
            ('P00696', '0.0', '8.7'),
            ('P00699', '0.0', '8.8'),
            ('P00702', '0.0', '0.6'),
            ('P00705', '0.0', '5.2'),
            ('P00708', '0.0', '1.8'),
            ('P00711', '0.0', '0.2'),
            ('P00714', '0.0', '0.9'),
            ('P00717', '0.0', '7.3'),
            ('P00720', '0.0', '9.5'),
            ('P00723', '0.0', '5.8'),
            ('P00726', '0.0', '2.7'),
            ('P00729', '0.0', '5.2'),
            ('P00732', '0.0', '4.3'),
            ('P00735', '0.0', '9.1'),
            ('P00738', '0.0', '7.1'),
            ('P00741', '0.0', '7.8'),
            ('P00744', '0.0', '8.8'),
            ('P00747', '0.0', '3.1'),
            ('P00750', '0.0', '9.8'),
            ('P00753', '0.0', '1.8'),
            ('P00756', '0.0', '5.9'),
            ('P00759', '0.0', '8.0'),
            ('P00762', '0.0', '1.1'),
            ('P00765', '0.0', '3.0'),
            ('P00768', '0.0', '2.3'),
            ('P00771', '0.0', '5.2'),
            ('P00774', '0.0', '7.6'),
            ('P00777', '0.0', '6.9'),
            ('P00780', '0.0', '5.6'),
            ('P00783', '0.0', '8.5'),
            ('P00786', '0.0', '7.7'),
            ('P00789', '0.0', '4.7'),
            ('P00792', '0.0', '8.6'),
            ('P00795', '0.0', '7.7'),
            ('P00798', '0.0', '2.0'),
            ('P00801', '0.0', '4.7'),
            ('P00804', '0.0', '2.8'),
            ('P00807', '0.0', '6.6'),
            ('P00810', '0.0', '1.7'),
            ('P00813', '0.0', '3.6'),
            ('P00816', '0.0', '3.6'),
            ('P00819', '0.0', '8.9'),
            ('P00822', '0.0', '7.8'),
            ('P00825', '0.0', '2.3'),
            ('P00828', '0.0', '9.2'),
            ('P00831', '0.0', '2.8'),
            ('P00834', '0.0', '3.4'),
            ('P00837', '0.0', '0.4'),
            ('P00840', '0.0', '0.1'),
            ('P00843', '0.0', '9.0'),
            ('P00846', '0.0', '0.5'),
            ('P00849', '0.0', '8.7'),
            ('P00852', '0.0', '9.1'),
            ('P00855', '0.0', '3.4'),
            ('P00858', '0.0', '10.0'),
            ('P00861', '0.0', '9.1'),
            ('P00864', '0.0', '4.7'),
            ('P00867', '0.0', '2.4'),
            ('P00870', '0.0', '3.2'),
            ('P00873', '0.0', '0.2'),
            ('P00876', '0.0', '6.2'),
            ('P00879', '0.0', '8.5'),
            ('P00882', '0.0', '3.4'),
            ('P00885', '0.0', '3.1'),
            ('P00888', '0.0', '5.6'),
            ('P00891', '0.0', '8.9'),
            ('P00894', '0.0', '3.9'),
            ('P00897', '0.0', '5.9'),
            ('P00900', '0.0', '0.8'),
            ('P00903', '0.0', '4.4'),
            ('P00906', '0.0', '5.0'),
            ('P00909', '0.0', '3.3'),
            ('P00912', '0.0', '3.3'),
            ('P00915', '0.0', '4.8'),
            ('P00918', '0.0', '1.4'),
            ('P00921', '0.0', '0.8'),
            ('P00924', '0.0', '4.2'),
            ('P00927', '0.0', '1.4'),
            ('P00930', '0.0', '1.9'),
            ('P00933', '0.0', '7.0'),
            ('P00936', '0.0', '5.1'),
            ('P00939', '0.0', '5.5'),
            ('P00942', '0.0', '6.7'),
            ('P00945', '0.0', '3.3'),
            ('P00948', '0.0', '2.0'),
            ('P00951', '0.0', '8.2'),
            ('P00954', '0.0', '2.9'),
            ('P00957', '0.0', '7.7'),
            ('P00960', '0.0', '4.1'),
            ('P00963', '0.0', '7.0'),
            ('P00966', '0.0', '9.2'),
            ('P00969', '0.0', '6.6'),
            ('P00972', '0.0', '6.7'),
            ('P00975', '0.0', '2.6'),
            ('P00978', '0.0', '5.5'),
            ('P00981', '0.0', '1.3'),
            ('P00984', '0.0', '3.0'),
            ('P00987', '0.0', '0.4'),
            ('P00990', '0.0', '8.0'),
            ('P00993', '0.0', '2.7'),
            ('P00996', '0.0', '4.8'),
            ('P00999', '0.0', '3.7');"""
        )
finally:
    if conn:
        conn.close()
